#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üîç Running lint-staged..."
npx lint-staged

echo ""
echo "Running Semgrep security checks..."
if command -v semgrep >/dev/null 2>&1; then
  semgrep scan \
    --config=p/security-audit \
    --config=p/secrets \
    --config=p/owasp-top-ten \
    --config=p/nodejs \
    --error \
    --quiet \
    || {
      echo "‚ùå Semgrep found security issues!"
      echo "To skip this check (not recommended): git commit --no-verify"
      exit 1
    }
  echo "‚úÖ Semgrep checks passed!"
else
  echo "‚ö†Ô∏è  Semgrep not installed. Install with: pip install semgrep"
  echo "   Skipping Semgrep checks..."
fi
